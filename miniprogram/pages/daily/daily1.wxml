<!--pages/daily/daily1.wxml-->
<view class="flex-col page">
  <!-- 主要内容区域 - 白色底板 -->
  <view class="content-overlay">
    
    <!-- 日期信息区域 -->
    <view class="flex-col">
      <view class="flex-row justify-between items-center">
        <!-- 月份显示（英文） -->
        <text class="self-start text">{{month}}</text>
        <!-- 农历年份 -->
        <text class="self-end year-text">{{year}}年</text>
      </view>
      <view class="flex-row justify-between group mt-7">
        <!-- 日期 -->
        <text class="text_3">{{day}}</text>
        <!-- 农历日期和星期 -->
        <view class="flex-col items-end">
          <text class="self-end font text_4">{{lunarDate}}</text>
          <text class="self-end font text_4 mt-2">{{weekDay}}</text>
        </view>
      </view>
    </view>
    
    <!-- 卡牌区域 - 多层叠加效果，居中显示 -->
    <view class="card-section">
      <view class="card-stack-container">
        <!-- 底层背景 -->
        <image class="card-layer card-base" src="/images/right_card.png" />
        <!-- 装饰层 -->
        <image class="card-layer card-decor" src="/images/left_card.png" />
        <!-- 主卡牌 - 移除倾斜效果，使用官方长按识别 -->
        <view class="card-layer card-main">
          <image 
            class="main-image" 
            src="{{displayImage}}" 
            show-menu-by-longpress="{{true}}"
          />
        </view>
      </view>
    </view>

    <!-- 金句区域 - 在卡牌下方居中显示 -->
    <view class="wisdom-section">
      <text class="wisdom-text">
        {{wisdomQuote || '静坐觉察，每日修行。保持内心的平静与专注。'}}
      </text>
    </view>
    
    <!-- 用户信息和统计区域 -->
    <view class="flex-col group_3">
      <view class="flex-row justify-end items-center group_4">
        <!-- 用户头像 -->
        <view class="flex-col justify-start items-center relative group_7">
          <image
            class="image_2"
            src="{{userAvatar || '/images/avatar.png'}}"
          />
          <!-- 最高等级文字 -->
          <view class="highest-level-text" wx:if="{{highestLevelBadge}}">
            <text class="level-text">{{highestLevelBadge.name}}</text>
          </view>
        </view>
        
        <!-- 用户信息区域 -->
        <view class="flex-col group_5">
          <!-- 用户信息和等级 -->
          <view class="flex-row items-center group_6">
            <text class="font_2 text_6">{{userName || '静心者'}}</text>
            <!-- 等级显示和最高等级勋章 -->
            <view class="highest-level-badge" wx:if="{{highestLevelBadge}}">
              <image 
                class="level-badge-icon" 
                src="{{highestLevelBadge.imageUrl}}" 
                mode="aspectFit"
              />
              
            </view>
          </view>
          
          <!-- 打卡统计 -->
          <view class="mt-6 flex-row group_6">
            <view class="flex-col items-start equal-division-item">
              <text class="font_4">{{totalCount || 0}}次</text>
              <text class="mt-8 font_3">今日打卡</text>
            </view>
            <view class="flex-col items-start equal-division-item ml-102">
              <text class="font_4">{{totalMinutes || 0}}分钟</text>
              <text class="mt-8 font_3">本次觉察时长</text>
            </view>
          </view>
        </view>
        
        <!-- 觉察计时器 -->
        <view class="flex-col items-start equal-division-item">
          <image class="image_6" src="/images/miniP.jpg"/>
          <text class="mt-8 font_3">觉察计时器</text>
        </view>
      </view>
      
        <!-- 分享按钮 -->
        <view class="mt-12 flex-row justify-center items-center section" bindtap="shareToWechat">
          <image
            class="image_3"
            src="/images/icons/share.png"
          />
          <text class="font_2 text_9 ml-9">立即分享</text>
        </view>
    </view>
  </view>
  
  <!-- 隐藏的Canvas用于图片生成 -->
  <canvas canvas-id="dailyCanvas" style="position: fixed; left: -1000px; top: -1000px; width: 750px; height: 1334px;"></canvas>
</view>